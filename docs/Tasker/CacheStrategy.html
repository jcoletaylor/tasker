<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Tasker::CacheStrategy
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Tasker::CacheStrategy";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Tasker.html" title="Tasker (module)">Tasker</a></span></span>
     &raquo; 
    <span class="title">CacheStrategy</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Tasker::CacheStrategy
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Tasker::CacheStrategy</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="Concerns/StructuredLogging.html" title="Tasker::Concerns::StructuredLogging (module)">Tasker::Concerns::StructuredLogging</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/tasker/cache_strategy.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Unified cache capability detection and strategy management</p>

<p>This class consolidates cache store introspection from MetricsBackend and IntelligentCacheManager into a single, comprehensive system that:</p>
<ol><li>
<p>Detects capabilities of all major Rails cache stores</p>
</li><li>
<p>Supports Solid Cache and other modern Rails cache stores</p>
</li><li>
<p>Provides extensibility for custom cache implementations</p>
</li><li>
<p>Offers a consistent API for cache strategy selection</p>
</li></ol>

<p><strong>Phase 2.1.1 Enhancement: Hybrid Cache Store Detection System</strong> Combines frozen constants for built-in Rails cache stores with declared capabilities for custom cache stores, creating a robust and extensible architecture.</p>

<p>Detection Priority Order: 1. Declared capabilities (highest priority) - explicit developer declarations 2. Built-in store constants - fast, reliable detection for known stores 3. Custom detectors - pattern-based registration for legacy compatibility 4. Runtime detection - conservative fallback for unknown stores</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Basic usage</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_strategy'>strategy</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tasker.html" title="Tasker (module)">Tasker</a></span></span><span class='op'>::</span><span class='const'>CacheStrategy</span><span class='period'>.</span><span class='id identifier rubyid_detect'><span class='object_link'><a href="#detect-class_method" title="Tasker::CacheStrategy.detect (method)">detect</a></span></span>
<span class='id identifier rubyid_strategy'>strategy</span><span class='period'>.</span><span class='id identifier rubyid_coordination_mode'>coordination_mode</span>  <span class='comment'># =&gt; :distributed_atomic
</span><span class='id identifier rubyid_strategy'>strategy</span><span class='period'>.</span><span class='id identifier rubyid_supports?'>supports?</span><span class='lparen'>(</span><span class='symbol'>:locking</span><span class='rparen'>)</span> <span class='comment'># =&gt; true</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Custom detector registration</p>
</div></h5>
      
      <pre class="example code"><code><span class='const'><span class='object_link'><a href="../Tasker.html" title="Tasker (module)">Tasker</a></span></span><span class='op'>::</span><span class='const'>CacheStrategy</span><span class='period'>.</span><span class='id identifier rubyid_register_detector'><span class='object_link'><a href="#register_detector-class_method" title="Tasker::CacheStrategy.register_detector (method)">register_detector</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>MyCache</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_store'>store</span><span class='rparen'>)</span> <span class='tlambeg'>{</span>
  <span class='lbrace'>{</span> <span class='label'>distributed:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>custom_feature:</span> <span class='kw'>true</span> <span class='rbrace'>}</span>
<span class='rbrace'>}</span><span class='rparen'>)</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Custom cache store with capabilities</p>
</div></h5>
      
      <pre class="example code"><code><span class='kw'>class</span> <span class='const'>MyAwesomeCacheStore</span> <span class='op'>&lt;</span> <span class='const'>ActiveSupport</span><span class='op'>::</span><span class='const'>Cache</span><span class='op'>::</span><span class='const'>Store</span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="../Tasker.html" title="Tasker (module)">Tasker</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="CacheCapabilities.html" title="Tasker::CacheCapabilities (module)">CacheCapabilities</a></span></span>
  <span class='id identifier rubyid_supports_distributed_caching!'>supports_distributed_caching!</span>
  <span class='id identifier rubyid_supports_atomic_increment!'>supports_atomic_increment!</span>
<span class='kw'>end</span>

<span class='comment'># Configure Rails to use your custom store
</span><span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_configure'>configure</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_cache_store'>cache_store</span> <span class='op'>=</span> <span class='const'>MyAwesomeCacheStore</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='kw'>end</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Direct instantiation</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_strategy'>strategy</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tasker.html" title="Tasker (module)">Tasker</a></span></span><span class='op'>::</span><span class='const'>CacheStrategy</span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Tasker::CacheStrategy#initialize (method)">new</a></span></span></code></pre>
    
  </div>


</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="COORDINATION_STRATEGIES-constant" class="">COORDINATION_STRATEGIES =
          <div class="docstring">
  <div class="discussion">
    
<p>Cache store coordination strategies</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
  <span class='label'>distributed_atomic:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Full distributed coordination with atomic operations</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='label'>distributed_basic:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Basic distributed coordination with read-modify-write</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='label'>local_only:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Local-only coordination for single-process deployments</span><span class='tstring_end'>&#39;</span></span>
<span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="DISTRIBUTED_CACHE_STORES-constant" class="">DISTRIBUTED_CACHE_STORES =
          <div class="docstring">
  <div class="discussion">
    
<p>âœ… CONSTANTS: Official Rails cache store class names (validated against Rails 8.0+ docs) These provide O(1) lookup performance for built-in Rails cache stores</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='qwords_beg'>%w[</span><span class='words_sep'>
  </span><span class='tstring_content'>ActiveSupport::Cache::RedisCacheStore</span><span class='words_sep'>
  </span><span class='tstring_content'>ActiveSupport::Cache::MemCacheStore</span><span class='words_sep'>
  </span><span class='tstring_content'>SolidCache::Store</span><span class='words_sep'>
</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="ATOMIC_INCREMENT_STORES-constant" class="">ATOMIC_INCREMENT_STORES =
          
        </dt>
        <dd><pre class="code"><span class='qwords_beg'>%w[</span><span class='words_sep'>
  </span><span class='tstring_content'>ActiveSupport::Cache::RedisCacheStore</span><span class='words_sep'>
  </span><span class='tstring_content'>ActiveSupport::Cache::MemCacheStore</span><span class='words_sep'>
  </span><span class='tstring_content'>SolidCache::Store</span><span class='words_sep'>
</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="LOCKING_CAPABLE_STORES-constant" class="">LOCKING_CAPABLE_STORES =
          
        </dt>
        <dd><pre class="code"><span class='qwords_beg'>%w[</span><span class='words_sep'>
  </span><span class='tstring_content'>ActiveSupport::Cache::RedisCacheStore</span><span class='words_sep'>
  </span><span class='tstring_content'>SolidCache::Store</span><span class='words_sep'>
</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="LOCAL_CACHE_STORES-constant" class="">LOCAL_CACHE_STORES =
          
        </dt>
        <dd><pre class="code"><span class='qwords_beg'>%w[</span><span class='words_sep'>
  </span><span class='tstring_content'>ActiveSupport::Cache::MemoryStore</span><span class='words_sep'>
  </span><span class='tstring_content'>ActiveSupport::Cache::FileStore</span><span class='words_sep'>
  </span><span class='tstring_content'>ActiveSupport::Cache::NullStore</span><span class='words_sep'>
</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
    </dl>
  



  
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="Concerns/StructuredLogging.html" title="Tasker::Concerns::StructuredLogging (module)">Tasker::Concerns::StructuredLogging</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Concerns/StructuredLogging.html#CORRELATION_ID_KEY-constant" title="Tasker::Concerns::StructuredLogging::CORRELATION_ID_KEY (constant)">Tasker::Concerns::StructuredLogging::CORRELATION_ID_KEY</a></span></p>


  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#capabilities-instance_method" title="#capabilities (instance method)">#<strong>capabilities</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute capabilities.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#coordination_mode-instance_method" title="#coordination_mode (instance method)">#<strong>coordination_mode</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute coordination_mode.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#instance_id-instance_method" title="#instance_id (instance method)">#<strong>instance_id</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute instance_id.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#store-instance_method" title="#store (instance method)">#<strong>store</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute store.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#store_class_name-instance_method" title="#store_class_name (instance method)">#<strong>store_class_name</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute store_class_name.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clear_detectors!-class_method" title="clear_detectors! (class method)">.<strong>clear_detectors!</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Clear all registered detectors (primarily for testing).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#detect-class_method" title="detect (class method)">.<strong>detect</strong>  &#x21d2; Tasker::CacheStrategy </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Detect cache strategy for the current Rails.cache store.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#register_detector-class_method" title="register_detector (class method)">.<strong>register_detector</strong>(pattern, detector)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Register a custom cache store detector.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#export_capabilities-instance_method" title="#export_capabilities (instance method)">#<strong>export_capabilities</strong>  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Export capabilities for backward compatibility.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>  &#x21d2; CacheStrategy </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a strategy for the current Rails.cache store.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#supports%3F-instance_method" title="#supports? (instance method)">#<strong>supports?</strong>(capability)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Check if store supports a specific capability.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Concerns/StructuredLogging.html" title="Tasker::Concerns::StructuredLogging (module)">Tasker::Concerns::StructuredLogging</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Concerns/StructuredLogging.html#correlation_id-instance_method" title="Tasker::Concerns::StructuredLogging#correlation_id (method)">#correlation_id</a></span>, <span class='object_link'><a href="Concerns/StructuredLogging.html#correlation_id=-instance_method" title="Tasker::Concerns::StructuredLogging#correlation_id= (method)">#correlation_id=</a></span>, <span class='object_link'><a href="Concerns/StructuredLogging.html#log_exception-instance_method" title="Tasker::Concerns::StructuredLogging#log_exception (method)">#log_exception</a></span>, <span class='object_link'><a href="Concerns/StructuredLogging.html#log_orchestration_event-instance_method" title="Tasker::Concerns::StructuredLogging#log_orchestration_event (method)">#log_orchestration_event</a></span>, <span class='object_link'><a href="Concerns/StructuredLogging.html#log_performance_event-instance_method" title="Tasker::Concerns::StructuredLogging#log_performance_event (method)">#log_performance_event</a></span>, <span class='object_link'><a href="Concerns/StructuredLogging.html#log_step_event-instance_method" title="Tasker::Concerns::StructuredLogging#log_step_event (method)">#log_step_event</a></span>, <span class='object_link'><a href="Concerns/StructuredLogging.html#log_structured-instance_method" title="Tasker::Concerns::StructuredLogging#log_structured (method)">#log_structured</a></span>, <span class='object_link'><a href="Concerns/StructuredLogging.html#log_task_event-instance_method" title="Tasker::Concerns::StructuredLogging#log_task_event (method)">#log_task_event</a></span>, <span class='object_link'><a href="Concerns/StructuredLogging.html#with_correlation_id-instance_method" title="Tasker::Concerns::StructuredLogging#with_correlation_id (method)">#with_correlation_id</a></span></p>

  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>  &#x21d2; <tt><span class='object_link'><a href="" title="Tasker::CacheStrategy (class)">CacheStrategy</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a strategy for the current Rails.cache store</p>

<p>The cache strategy always analyzes Rails.cache, which is the single source of truth for caching in Rails applications. Custom cache stores should be configured through Rails.cache and declare their capabilities via the CacheCapabilities module.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tasker/cache_strategy.rb', line 114</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
  <span class='ivar'>@detector_registry</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="DetectorRegistry.html" title="Tasker::DetectorRegistry (class)">DetectorRegistry</a></span></span><span class='period'>.</span><span class='id identifier rubyid_instance'>instance</span>
  <span class='ivar'>@instance_id</span> <span class='op'>=</span> <span class='id identifier rubyid_generate_instance_id'>generate_instance_id</span>

  <span class='comment'># Handle Rails.cache unavailability gracefully
</span>  <span class='kw'>begin</span>
    <span class='ivar'>@store</span> <span class='op'>=</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_cache'>cache</span>
    <span class='ivar'>@store_class_name</span> <span class='op'>=</span> <span class='ivar'>@store</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='kw'>rescue</span> <span class='const'>StandardError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_log_structured'>log_structured</span><span class='lparen'>(</span><span class='symbol'>:warn</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Rails.cache unavailable, using fallback configuration</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
                   <span class='label'>error:</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='comma'>,</span>
                   <span class='label'>instance_id:</span> <span class='ivar'>@instance_id</span><span class='rparen'>)</span>
    <span class='ivar'>@store</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@store_class_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Unknown</span><span class='tstring_end'>&#39;</span></span>
    <span class='ivar'>@capabilities</span> <span class='op'>=</span> <span class='id identifier rubyid_default_capabilities'>default_capabilities</span>
    <span class='ivar'>@coordination_mode</span> <span class='op'>=</span> <span class='symbol'>:local_only</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='comment'># Generate cache key that includes store configuration
</span>  <span class='id identifier rubyid_cache_key'>cache_key</span> <span class='op'>=</span> <span class='id identifier rubyid_generate_cache_key'>generate_cache_key</span><span class='lparen'>(</span><span class='ivar'>@store</span><span class='comma'>,</span> <span class='ivar'>@store_class_name</span><span class='rparen'>)</span>

  <span class='comment'># Check for cached strategy first
</span>  <span class='id identifier rubyid_cached'>cached</span> <span class='op'>=</span> <span class='ivar'>@detector_registry</span><span class='period'>.</span><span class='id identifier rubyid_cached_strategy_for'>cached_strategy_for</span><span class='lparen'>(</span><span class='id identifier rubyid_cache_key'>cache_key</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_cached'>cached</span>
    <span class='ivar'>@capabilities</span> <span class='op'>=</span> <span class='id identifier rubyid_cached'>cached</span><span class='period'>.</span><span class='id identifier rubyid_capabilities'>capabilities</span>
    <span class='ivar'>@coordination_mode</span> <span class='op'>=</span> <span class='id identifier rubyid_cached'>cached</span><span class='period'>.</span><span class='id identifier rubyid_coordination_mode'>coordination_mode</span>
  <span class='kw'>else</span>
    <span class='comment'># Detect capabilities with error handling
</span>    <span class='kw'>begin</span>
      <span class='ivar'>@capabilities</span> <span class='op'>=</span> <span class='id identifier rubyid_detect_capabilities'>detect_capabilities</span>
      <span class='ivar'>@coordination_mode</span> <span class='op'>=</span> <span class='id identifier rubyid_select_coordination_strategy'>select_coordination_strategy</span>

      <span class='comment'># Cache this strategy instance
</span>      <span class='ivar'>@detector_registry</span><span class='period'>.</span><span class='id identifier rubyid_cache_strategy_for'>cache_strategy_for</span><span class='lparen'>(</span><span class='id identifier rubyid_cache_key'>cache_key</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='const'>StandardError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
      <span class='id identifier rubyid_log_structured'>log_structured</span><span class='lparen'>(</span><span class='symbol'>:warn</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Cache detection failed</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
                     <span class='label'>error:</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='comma'>,</span>
                     <span class='label'>store_class:</span> <span class='ivar'>@store_class_name</span><span class='comma'>,</span>
                     <span class='label'>instance_id:</span> <span class='ivar'>@instance_id</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_log_structured'>log_structured</span><span class='lparen'>(</span><span class='symbol'>:warn</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Falling back to local-only mode</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='ivar'>@store_class_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Unknown</span><span class='tstring_end'>&#39;</span></span>
      <span class='ivar'>@capabilities</span> <span class='op'>=</span> <span class='id identifier rubyid_default_capabilities'>default_capabilities</span>
      <span class='ivar'>@coordination_mode</span> <span class='op'>=</span> <span class='symbol'>:local_only</span>
      <span class='kw'>return</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_log_strategy_detection'>log_strategy_detection</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="capabilities-instance_method">
  
    #<strong>capabilities</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute capabilities.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tasker/cache_strategy.rb', line 86</span>

<span class='kw'>def</span> <span class='id identifier rubyid_capabilities'>capabilities</span>
  <span class='ivar'>@capabilities</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="coordination_mode-instance_method">
  
    #<strong>coordination_mode</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute coordination_mode.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tasker/cache_strategy.rb', line 86</span>

<span class='kw'>def</span> <span class='id identifier rubyid_coordination_mode'>coordination_mode</span>
  <span class='ivar'>@coordination_mode</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="instance_id-instance_method">
  
    #<strong>instance_id</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute instance_id.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tasker/cache_strategy.rb', line 86</span>

<span class='kw'>def</span> <span class='id identifier rubyid_instance_id'>instance_id</span>
  <span class='ivar'>@instance_id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="store-instance_method">
  
    #<strong>store</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute store.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tasker/cache_strategy.rb', line 86</span>

<span class='kw'>def</span> <span class='id identifier rubyid_store'>store</span>
  <span class='ivar'>@store</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="store_class_name-instance_method">
  
    #<strong>store_class_name</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute store_class_name.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tasker/cache_strategy.rb', line 86</span>

<span class='kw'>def</span> <span class='id identifier rubyid_store_class_name'>store_class_name</span>
  <span class='ivar'>@store_class_name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="clear_detectors!-class_method">
  
    .<strong>clear_detectors!</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Clear all registered detectors (primarily for testing)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


104
105
106</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tasker/cache_strategy.rb', line 104</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_clear_detectors!'>clear_detectors!</span>
  <span class='const'><span class='object_link'><a href="DetectorRegistry.html" title="Tasker::DetectorRegistry (class)">DetectorRegistry</a></span></span><span class='period'>.</span><span class='id identifier rubyid_instance'>instance</span><span class='period'>.</span><span class='id identifier rubyid_clear_detectors!'>clear_detectors!</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="detect-class_method">
  
    .<strong>detect</strong>  &#x21d2; <tt><span class='object_link'><a href="" title="Tasker::CacheStrategy (class)">Tasker::CacheStrategy</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Detect cache strategy for the current Rails.cache store</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Tasker::CacheStrategy (class)">Tasker::CacheStrategy</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Strategy instance for Rails.cache</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tasker/cache_strategy.rb', line 91</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_detect'>detect</span>
  <span class='id identifier rubyid_new'>new</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="register_detector-class_method">
  
    .<strong>register_detector</strong>(pattern, detector)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Register a custom cache store detector</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>pattern</span>
      
      
        <span class='type'>(<tt>Regexp</tt>, <tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Pattern to match store class names</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>detector</span>
      
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Detector that returns capabilities hash</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


99
100
101</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tasker/cache_strategy.rb', line 99</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_register_detector'>register_detector</span><span class='lparen'>(</span><span class='id identifier rubyid_pattern'>pattern</span><span class='comma'>,</span> <span class='id identifier rubyid_detector'>detector</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="DetectorRegistry.html" title="Tasker::DetectorRegistry (class)">DetectorRegistry</a></span></span><span class='period'>.</span><span class='id identifier rubyid_instance'>instance</span><span class='period'>.</span><span class='id identifier rubyid_register_detector'>register_detector</span><span class='lparen'>(</span><span class='id identifier rubyid_pattern'>pattern</span><span class='comma'>,</span> <span class='id identifier rubyid_detector'>detector</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="export_capabilities-instance_method">
  
    #<strong>export_capabilities</strong>  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Export capabilities for backward compatibility</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Hash of capabilities for legacy integrations</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


176
177
178</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tasker/cache_strategy.rb', line 176</span>

<span class='kw'>def</span> <span class='id identifier rubyid_export_capabilities'>export_capabilities</span>
  <span class='ivar'>@capabilities</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="supports?-instance_method">
  
    #<strong>supports?</strong>(capability)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Check if store supports a specific capability</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>capability</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Capability to check (:distributed, :atomic_increment, etc.)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>True if capability is supported</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


169
170
171</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tasker/cache_strategy.rb', line 169</span>

<span class='kw'>def</span> <span class='id identifier rubyid_supports?'>supports?</span><span class='lparen'>(</span><span class='id identifier rubyid_capability'>capability</span><span class='rparen'>)</span>
  <span class='ivar'>@capabilities</span><span class='lbracket'>[</span><span class='id identifier rubyid_capability'>capability</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sat Jun 28 15:42:30 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.2.4).
</div>

    </div>
  </body>
</html>